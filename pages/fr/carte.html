<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carte des Emplacements Publicitaires - Xtranumerik</title>
    <meta name="description" content="Explorez les emplacements publicitaires disponibles avec Xtranumerik √† travers notre carte interactive. R√©servez vos spots facilement !">
    <meta name="keywords" content="carte publicitaire, emplacements publicitaires, affichage dynamique, Xtranumerik">
    <meta name="author" content="Xtranumerik">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Carte des Emplacements Publicitaires - Xtranumerik">
    <meta property="og:description" content="D√©couvrez et r√©servez des emplacements publicitaires avec la carte interactive de Xtranumerik.">
    <meta property="og:image" content="https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/aee0b749-f8da-4823-b82d-2e2430e72d63/Fond+du+site+web+Xtranumerik.png?format=2500w">
    <meta property="og:url" content="https://www.xtranumerik.ca/map">
    <meta property="og:type" content="website">
    <link rel="canonical" href="https://www.xtranumerik.ca/map">
    <link rel="alternate" href="https://xtranumerik.ca/en/map" hreflang="en">
    <link rel="alternate" href="https://xtranumerik.ca/fr/carte" hreflang="fr">

    <!-- Styles from second script -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/components.css">
    <link rel="stylesheet" href="/assets/css/animations.css">
    <link rel="stylesheet" href="/assets/css/responsive.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Styles sp√©cifiques from first script, adapted -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', sans-serif;
            color: #333;
            background-color: #f9f9fb;
            line-height: 1.6;
        }
        .section {
            width: 100%;
            padding: 60px 20px;
        }
        .content-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .background-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 40%;
            background-image: url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            z-index: -1;
        }
        .language-toggle, .link-button {
            padding: 10px 20px;
            background-color: #D4A017;
            color: #1A2A44;
            font-size: 0.95rem;
            font-weight: 600;
            border: none;
            border-radius: 25px;
            text-decoration: none;
            cursor: pointer;
        }
        .language-toggle:hover, .link-button:hover {
            background-color: #1A2A44;
            color: #fff;
        }
        .map-container {
            height: 550px;
            width: 100%;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-strong);
            position: relative;
            z-index: 1;
        }
        #map-fr {
            height: 100%;
            width: 100%;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }
        .watermark {
            position: absolute;
            bottom: 10px;
            right: 10px;
            max-width: 120px;
            opacity: 0.2;
            pointer-events: none;
            z-index: 1000;
        }
        .leaflet-popup-content-wrapper {
            background-color: #1A2A44;
            color: #fff;
            border-radius: 6px;
        }
        .leaflet-popup-tip {
            background-color: #1A2A44;
        }
        .ad-popup {
            text-align: center;
            padding: 12px;
            max-width: 250px;
        }
        .ad-popup h3 {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #D4A017;
        }
        .ad-popup img {
            max-width: 100%;
            max-height: 120px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .ad-popup button {
            background-color: #D4A017;
            color: #fff;
            padding: 8px 12px;
            font-size: 0.9rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .ad-popup button:hover {
            background-color: #1A2A44;
        }
        .ad-popup.reserved button.reserve-btn {
            background-color: #1A2A44;
        }
        .ad-popup.reserved button.reserve-btn:hover {
            background-color: #D4A017;
        }
        #email-section .textarea-container {
            position: relative;
        }
        #email-section textarea {
            width: 100%;
            height: 150px;
            padding: 12px;
            font-size: 1rem;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
            resize: vertical;
            background-color: #fff;
            color: #1A2A44;
        }
        #email-section button {
            background-color: #D4A017;
            color: #fff;
            padding: 10px 20px;
            font-size: 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        #email-section button:hover {
            background-color: #1A2A44;
        }
        #send-email-fr, #reset-button {
            display: none;
        }
        #reset-button {
            position: absolute;
            bottom: 10px;
            right: 10px;
            padding: 8px 16px;
            font-size: 0.9rem;
        }
        .error-message {
            color: red;
            text-align: center;
            padding: 20px;
            font-size: 1rem;
        }
        @media (max-width: 768px) {
            .section {
                padding: 40px 20px;
            }
            .language-toggle, .link-button {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
            .map-container {
                padding: 10px;
            }
            #map-fr {
                height: 400px;
            }
            .background-image {
                height: 50%;
            }
            .ad-popup h3 {
                font-size: 0.95rem;
            }
            .ad-popup img {
                max-height: 100px;
            }
            .ad-popup button {
                font-size: 0.8rem;
                padding: 6px 10px;
            }
            #email-section textarea {
                font-size: 0.9rem;
                height: 120px;
            }
            #email-section button {
                font-size: 0.9rem;
                padding: 8px 16px;
            }
            #reset-button {
                bottom: 5px;
                right: 5px;
                padding: 6px 12px;
                font-size: 0.8rem;
            }
        }

        /* Additional styles from second script for map */
        .map-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .map-control-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 5px;
            padding: 0.5rem;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            transition: var(--transition-smooth);
        }
        .map-control-btn:hover {
            background: var(--secondary-color);
            color: white;
        }
        .location-popup {
            text-align: center;
            min-width: 200px;
        }
        .popup-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        .popup-address {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 1rem;
        }
        .popup-reserve-btn {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 0.5rem 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-smooth);
        }
        .popup-reserve-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 169, 26, 0.3);
        }
        .location-list {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 1rem;
        }
        .location-item {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: var(--transition-smooth);
        }
        .location-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-strong);
        }
        .location-item.selected {
            border-color: var(--secondary-color);
            background: rgba(255, 169, 26, 0.1);
        }
        .xtranumerik-watermark {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(25, 5, 68, 0.8);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 3px;
            font-size: 0.7rem;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <!-- Header from second script -->
    <!-- Inject√© depuis components/header.html -->

    <main>
        <!-- Hero Section from second script, adapted to first -->
        <section class="map-hero section" style="background: var(--gradient-primary); color: var(--text-light); padding: 3rem 0;">
            <div class="container">
                <div class="hero-content text-center" data-animate="fade-in">
                    <h1 class="hero-title">Carte des Emplacements Publicitaires</h1>
                    <p class="hero-description" style="font-size: 1.2rem; margin: 1rem auto; max-width: 600px;">
                        D√©couvrez et r√©servez des emplacements publicitaires avec la carte interactive de Xtranumerik.
                    </p>
                </div>
            </div>
        </section>

        <div class="background-image"></div>

        <!-- Header container from first -->
        <section class="section">
            <div class="content-container header-container">
                <a href="https://xtranumerik.ca/fr/reseau-affichage" class="link-button" id="network-link-fr">Retour vers le site principal</a>
                <a href="https://xtranumerik.ca/en/map" class="language-toggle">English</a>
            </div>
        </section>

        <!-- Interactive Map Section from second, with map from first -->
        <section id="map-section" class="interactive-map-section section">
            <div class="container">
                <div class="map-layout grid grid-lg-3" style="gap: 3rem; align-items: start;">
                    <!-- Carte principale -->
                    <div class="map-wrapper" style="grid-column: 1 / -1; grid-column: lg-1 / lg-3;" data-animate="scale-in">
                        <div class="map-container">
                            <div id="map-fr"></div>
                            <img src="https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/913d56a4-7536-40b6-bbc0-4db0640301f0/Design+sans+titre.png?format=2500w" alt="Xtranumerik Watermark" class="watermark">
                            <div class="map-controls">
                                <button class="map-control-btn" onclick="centerMap()">üìç Centrer</button>
                                <button class="map-control-btn" onclick="showAllLocations()">üåç Tout Voir</button>
                                <button class="map-control-btn" onclick="filterAvailable()">‚úÖ Disponibles</button>
                            </div>
                            <div class="xtranumerik-watermark">¬© Xtranumerik 2025</div>
                        </div>
                    </div>
                    <!-- Liste des emplacements from second, generated dynamically from first's data -->
                    <div class="locations-sidebar" data-animate="slide-up">
                        <h3 class="sidebar-title">Nos Emplacements</h3>
                        <div class="location-list" id="location-list">
                            <!-- G√©n√©r√© dynamiquement -->
                        </div>
                        <div class="sidebar-cta" style="margin-top: 2rem;">
                            <div class="cta-card glass-card" style="text-align: center; padding: 2rem;">
                                <h4>Besoin d'Aide ?</h4>
                                <p style="margin: 1rem 0;">Contactez notre √©quipe pour choisir l'emplacement parfait</p>
                                <a href="mailto:patrick@xtranumerik.ca?subject=Consultation emplacements publicitaires"
                                   class="btn btn-primary">
                                    Parler √† un Expert
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Email Section from first -->
        <section id="email-section" class="section">
            <div class="content-container">
                <div class="textarea-container">
                    <textarea id="email-body-fr">Instructions :
1. Cliquez sur un emplacement sur la carte.
2. Appuyez sur "R√©server" pour ajouter l'emplacement √† votre s√©lection.
3. Consultez l'emplacement sur Google Maps en cliquant sur "Voir sur Google Maps".
4. Une fois vos emplacements choisis, modifiez ce texte si n√©cessaire.
5. Cliquez sur "Envoyer l'e-mail" pour soumettre votre demande √† Patrick.</textarea>
                    <button id="reset-button">R√©initialiser</button>
                </div>
                <button id="send-email-fr">Envoyer l'e-mail</button>
            </div>
        </section>

        <!-- Reservation Section from second -->
        <section class="reservation-section section" style="background: linear-gradient(135deg, #f8f9ff 0%, #e3e9ff 100%);">
            <div class="container">
                <div class="section-header text-center" data-animate="fade-in">
                    <h2 class="section-title">R√©servation Simple et Rapide</h2>
                    <p class="section-subtitle">Processus en 3 √©tapes pour r√©server votre espace</p>
                </div>
                <div class="process-steps grid grid-md-3" style="margin-top: 4rem;">
                    <div class="step-card glass-card text-center hover-lift" data-animate="scale-in">
                        <div class="step-number" style="background: var(--gradient-secondary); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; margin: 0 auto 1rem;">1</div>
                        <h3 class="step-title">Choisissez</h3>
                        <p class="step-description">S√©lectionnez l'emplacement qui correspond √† vos objectifs publicitaires</p>
                    </div>
                    <div class="step-card glass-card text-center hover-lift" data-animate="scale-in">
                        <div class="step-number" style="background: var(--gradient-secondary); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; margin: 0 auto 1rem;">2</div>
                        <h3 class="step-title">Contactez</h3>
                        <p class="step-description">Email automatique avec vos pr√©f√©rences envoy√© √† notre √©quipe</p>
                    </div>
                    <div class="step-card glass-card text-center hover-lift" data-animate="scale-in">
                        <div class="step-number" style="background: var(--gradient-secondary); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; margin: 0 auto 1rem;">3</div>
                        <h3 class="step-title">Lancez</h3>
                        <p class="step-description">Votre campagne publicitaire est en ligne sous 48h</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Final CTA from second -->
        <section class="final-cta section" style="background: var(--gradient-secondary); color: var(--text-light);">
            <div class="container">
                <div class="cta-content text-center" data-animate="fade-in">
                    <h2 class="cta-title">Pr√™t √† R√©server Votre Espace ?</h2>
                    <p class="cta-description" style="font-size: 1.2rem; margin: 2rem auto; max-width: 600px;">
                        Choisissez parmi nos emplacements premium et maximisez la visibilit√© de votre entreprise
                    </p>
                    <div class="cta-actions">
                        <a href="mailto:patrick@xtranumerik.ca?subject=R√©servation espace publicitaire&body=Bonjour,%0A%0AJe souhaiterais r√©server un espace publicitaire sur votre r√©seau.%0A%0AInformations sur ma demande:%0A- Entreprise: %0A- Emplacement souhait√©: %0A- Dur√©e de campagne: %0A- Budget approximatif: %0A%0AMerci de me contacter.%0A%0ACordialement"
                           class="btn btn-primary btn-large">
                            R√©server Maintenant
                        </a>
                        <p style="margin-top: 1rem; opacity: 0.9;">
                            üìû <a href="tel:581-705-8777" style="color: inherit;">581-705-8777</a> |
                            üìß <a href="mailto:patrick@xtranumerik.ca" style="color: inherit;">patrick@xtranumerik.ca</a>
                        </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer from second script -->
    <!-- Inject√© depuis components/footer.html -->

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="/assets/js/app.js"></script>
    <script src="/components/header.js"></script>

    <!-- Script from first, fused with second's logic -->
    <script>
        const adSpots = [
            { id: 1, lat: 45.9616571, lng: -70.9373016, name: "Restaurant Bar Royal", googleMapsUrl: "https://www.google.com/maps/place/Restaurant+Bar+Royal/@45.9616571,-70.9373016,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/6aef6a49-2d4d-44da-a813-ab9017c4cde9/%C3%89cran+Royal.png?format=2500w" },
            { id: 2, lat: 45.8576338, lng: -70.6342738, name: "Resto Mom's", googleMapsUrl: "https://www.google.com/maps/place/Resto+mom's/@45.8576338,-70.6342738,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/cf526810-3dc1-4873-9e93-d4ec9d72fa4e/Resto+MOM+PUB.png?format=2500w" },
            { id: 3, lat: 46.1504729, lng: -70.7762262, name: "NRJ Spa Nordique", googleMapsUrl: "https://www.google.com/maps/place/NRJ+Spa+Nordique/@46.1504729,-70.7762262,17z", imageUrl: "" },
            { id: 4, lat: 46.1090561, lng: -70.655366, name: "Boston Pizza", googleMapsUrl: "https://www.google.com/maps/place/Boston+Pizza/@46.1090561,-70.655366,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/7931ff7c-090d-49ac-9b2e-71cbe9312a67/Boston+pizza.png?format=2500w" },
            { id: 5, lat: 46.3096609, lng: -70.8797443, name: "Athl√©tik Culture GYM", googleMapsUrl: "https://www.google.com/maps/place/Athl%C3%A9tik+Culture+GYM/@46.3096609,-70.8797443,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/def3f0b8-b0da-44ae-a245-90837644710e/Athl%C3%A9tik+Culture+GYM.PNG?format=2500w" },
            { id: 6, lat: 45.9594959, lng: -70.6788479, name: "Casse-Cro√ªte Chez Marie", googleMapsUrl: "https://www.google.com/maps/place/Casse-Cro%C3%BBte+Chez+Marie/@45.9594959,-70.6788479,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/d5e1c4d2-4a70-4434-bb87-07b90eaf6016/Chez+Marie.PNG.jpg?format=2500w" },
            { id: 7, lat: 46.2140019, lng: -70.4803825, name: "La Grille Resto-Pub", googleMapsUrl: "https://www.google.com/maps/place/La+Grille+Resto-Pub/@46.2140019,-70.4803825,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/43af9cb5-7dbe-4cd8-be82-b32bccf66c75/La+grille.jpg?format=2500w" },
            { id: 8, lat: 46.2272334, lng: -70.513401, name: "March√© Abenakis", googleMapsUrl: "https://www.google.com/maps/place/March%C3%A9+Abenakis/@46.2272334,-70.513401,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/c2d6157a-e6b3-4eb1-a7c1-5edc68f57b81/March%C3%A9+Abenakis.jpg?format=2500w" },
            { id: 9, lat: 46.0114203, lng: -70.6178217, name: "Resto Parc 2000 Inc.", googleMapsUrl: "https://www.google.com/maps/place/Resto+Parc+2000+Inc./@46.0114203,-70.6178217,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/ac18f51a-35ee-4315-a920-276f2c0ee0a6/Resto+Parc+2000+Inc.jpg?format=2500w" },
            { id: 10, lat: 46.1470763, lng: -70.9063196, name: "Pizzeria Jippy", googleMapsUrl: "https://www.google.com/maps/place/Pizzeria+Jippy/@46.1470763,-70.9063196,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/0bd885fb-22cc-4a8b-946c-d657b4f6e72d/Pizza+Jippy.jpg?format=2500w" },
            { id: 11, lat: 46.4537792, lng: -71.0355562, name: "Gym √âlite Coach (24/7)", googleMapsUrl: "https://www.google.com/maps/place/Gym+%C3%89lite+Coach+(24%2F7)/@46.4537792,-71.0355562,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/3b92e63b-d8fd-44b4-8922-c5ad17fb06ea/Gym+%C3%89lite+Coach+St-Georges.jpg?format=2500w" },
            { id: 12, lat: 46.4362786, lng: -71.0208288, name: "Restaurant Giovannina", googleMapsUrl: "https://www.google.com/maps/place/Restaurant+Giovannina+%7C+Lounge,+Pizza,+Salades+%26+P%C3%A2tes+%C3%A0+Sainte-Marie/@46.4362786,-71.0208288,17z", imageUrl: "" },
            { id: 13, lat: 46.456531, lng: -71.036253, name: "Toujours Mikes", googleMapsUrl: "https://www.google.com/maps/place/Toujours+Mikes/@-71,-71,16z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/16da176c-db54-4116-924d-eaaafbb79c2c/Restaurant+Giovannina.jpg?format=2500w" },
            { id: 14, lat: 46.1290591, lng: -70.367007, name: "Restaurant √† la Bonne Fringale", googleMapsUrl: "https://www.google.com/maps/place/Restaurant+%C3%A0+la+Bonne+Fringale/@46.1290591,-70.367007,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/9d02dec0-44be-47cf-84bb-912c5bf67df2/Restaurant+%C3%A0+la+Bonne+Fringale.jpg?format=2500w" },
            { id: 15, lat: 46.4562891, lng: -71.0363647, name: "Les Galeries de la Chaudi√®re", googleMapsUrl: "https://www.google.com/maps/place/Les+Galeries+de+la+Chaudi%C3%A8re/@46.4562891,-71.0363647,17z", imageUrl: "" },
            { id: 16, lat: 46.1044769, lng: -71.2817687, name: "Resto-Truc", googleMapsUrl: "https://www.google.com/maps/place/Resto-Truc/@46.1044769,-71.2817687,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/6bec7d7b-cf26-40c7-8f0f-eace81361594/Resto+truc.jpg?format=2500w" },
            { id: 17, lat: 46.0964416, lng: -70.6463177, name: "Studio Sant√© Gym 24h", googleMapsUrl: "https://www.google.com/maps/place/Studio+Sant%C3%A9+Gym+24h/@46.0964416,-70.6463177,17z", imageUrl: "" },
            { id: 18, lat: 46.2106353, lng: -70.4825045, name: "Studio Sant√© Gym 24h (Saint-Prosper)", googleMapsUrl: "https://www.google.com/maps/place/Studio+Sant%C3%A9+Gym+24h/@46.2106353,-70.4825045,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/38f326a-e630fb88-f1d-7b3-dffe0e432fc.jpg?format=2500w" },
            { id: 19, lat: 46.2135047, lng: -70.4786834, name: "Clinique M√©dicale St-Prosper", googleMapsUrl: "https://www.google.com/maps/place/Clinique+Medicale+St-Prosper/@46.2135047,-70.4786834,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/dde0f0ba-7446-48c5-9e9e-043c719d2d109/Clinique+M%C3%A9dicale+St-Prosper.jpg?format=2500w" },
            { id: 20, lat: 46.3087423, lng: -70.8815006, name: "Resto l'Express", googleMapsUrl: "https://www.google.com/maps/place/Resto+l'Express/@46.3087423,-70.8815006,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/7b272211-07c7-4b35-85d4-581cb62877cd/Resto+l%27Express.jpg?format=2500w" },
            { id: 21, lat: 46.1142172, lng: -70.6749684, name: "Restaurant Le Sablonet", googleMapsUrl: "https://www.google.com/maps/place/Restaurant+Le+Sablonet/@46.1142172,-70.6749684,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/9dacd26d-f698-4f8f-81a9-ea19c556ecd9/Restaurant+Le+Sablonet.jpg?format=2500w" },
            { id: 22, lat: 46.1194527, lng: -70.6706433, name: "Salon Quilles Plus", googleMapsUrl: "https://www.google.com/maps/place/Salon+Quilles+Chez+Plus/@46.1194527,-70.6706433,17z", imageUrl: "" },
            { id: 23, lat: 46.0699824, lng: -70.7929689, name: "Resto VanLou", googleMapsUrl: "https://www.google.com/maps/place/Resto+Rick's/@46.0699824,-70.7929689,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/0b540555-29dd-48a6-8178-47c35f966940/Resto+VanLou.jpg?format=2500w" },
            { id: 24, lat: 46.1168869, lng: -70.6796526, name: "Restaurant Baril Grill", googleMapsUrl: "https://www.google.com/maps/place/Restaurant+Baril+Grill/@46.1168869,-70.6796526,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/6f80aaba-f2d4-4ab4-b32b-0540a3301c0d/Baril+Grill.jpg?format=2500w" },
            { id: 25, lat: 46.8363717, lng: -71.2924565, name: "Boxe Fit Qu√©bec", googleMapsUrl: "https://www.google.com/maps/place/Boxe+Fit+Qu%C3%A9bec/@46.8363717,-71.2924565,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/76d00d7c-bb88-462c-a4a9-d0b3584c9865/Boxe+Fit+Qu%C3%A9bec.jpg?format=2500w" },
            { id: 26, lat: 45.871817, lng: -70.9853831, name: "March√© Bonichoix", googleMapsUrl: "https://www.google.com/maps/place/March%C3%A9+Bonichoix+-+Alimentation+Elite+2005+inc./@45.871817,-70.9853831,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/edf0f4da-ad29-44ed-9c91-6ac81be443ec/Screenshot+2025-06-03+171724.png?format=2500w" },
            { id: 27, lat: 46.0953658, lng: -70.6430308, name: "Fromagerie la P√©pite d'Or", googleMapsUrl: "https://www.google.com/maps/place/Fromagerie+la+P%C3%A9pite+d'Or+Inc./@46.0953658,-70.6430308,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/d230aa6c-937a-4da5-a023-0066e482472f/Fromagerie+la+P%C3%A9pite+d%27Or.jpg?format=2500w" },
            { id: 28, lat: 45.9607918, lng: -70.8254776, name: "Saint-Honor√©-de-Shenley", googleMapsUrl: "https://www.google.com/maps/place/477+Rue+Principale,+Saint-Honor%C3%A9-de-Shenley,+QC+B4+7XG/@45.9607918,-70.8254776,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/b5a56569-81bc-4d87-8d68-a6a1b88ae618/Saint-Honor%C3%A9-de-Shenley.jpg?format=2500w" },
            { id: 29, lat: 46.214955, lng: -70.482596, name: "Proxim Pharmacie", googleMapsUrl: "https://www.google.com/maps/place/Proxim+pharmacie+affili%C3%A9e+-+Caroline+et+Julien+Sylvain/@46.214955,-70.482596,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/bd466c04-f835-4bb6-9cea-3a031a82c0a2/Clinique+PUB.png?format=2500w" },
            { id: 30, lat: 46.1182478, lng: -70.6713828, name: "Centre d'arts martiaux Kaizen", googleMapsUrl: "https://www.google.com/maps/place/Centre+d'arts+martiaux+Kaizen/@46.1182478,-70.6713828,17z", imageUrl: "https://images.squarespace-cdn.com/content/v1/657625271114fa52dac0d038/d9b5b1e2-248c-44ad-a5bc-e63403101c85/Centre+d%27arts+martiaux+Kaizen.jpg?format=2500w" }
        ];

        let reservedSpots = [];
        let mapFr;
        let markers = [];
        let selectedLocationId = null;

        // Initialisation from second
        document.addEventListener('DOMContentLoaded', function() {
            // Header
            const header = document.getElementById('main-header');
            if (header) {
                new HeaderComponent(header);
            }

            // Initialiser la carte from first
            mapFr = initializeMap('map-fr', 'fr');
            if (mapFr) {
                setupEventListeners('fr');
                updateEmailBody('fr');
                generateLocationList(); // From second, using adSpots data
            }
            window.addEventListener('resize', () => {
                if (mapFr) {
                    mapFr.invalidateSize();
                    console.log('Redimensionnement carte');
                }
            });
        });

        function initializeMap(mapId, lang) {
            try {
                console.log('Initialisation de la carte...');
                const map = L.map(mapId).setView([46.0, -70.7], 8); // From first
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                    maxZoom: 19
                }).addTo(map);

                markers = [];
                adSpots.forEach(spot => {
                    const marker = L.marker([spot.lat, spot.lng], {
                        spotId: spot.id
                    }).addTo(map);

                    marker.bindPopup(createPopupContent(spot, false, lang));
                    marker.on('click', () => {
                        console.log(`Clic sur marqueur ${spot.id} - ${spot.name}`);
                        marker.openPopup();
                        selectedLocationId = spot.id;
                        highlightLocationInList(spot.id);
                    });
                    markers.push({ marker, location: spot });
                });

                setTimeout(() => {
                    map.invalidateSize();
                    console.log('Carte redessin√©e');
                }, 100);

                return map;
            } catch (e) {
                console.error('Erreur initialisation carte:', e);
                document.getElementById(mapId).innerHTML = '<p class="error-message">Erreur de chargement de la carte. V√©rifiez votre connexion ou utilisez un navigateur √† jour.</p>';
                return null;
            }
        }

        function createPopupContent(spot, isReserved, lang) {
            try {
                console.log(`Cr√©ation popup pour spot ${spot.id}`);
                const imageHtml = spot.imageUrl ? `<img src="${spot.imageUrl}" alt="${spot.name}" style="max-width:100%;" onerror="this.style.display='none';" />` : '';
                return `
                    <div class="ad-popup location-popup" data-id="${spot.id}" data-reserved="${isReserved}">
                        <h3 class="popup-title">Spot ${spot.id} - ${spot.name}</h3>
                        ${imageHtml}
                        <button class="reserve-btn popup-reserve-btn" onclick="toggleReservation(${spot.id}, '${spot.name.replace(/'/g, "\\'")}', this, '${lang}')">${isReserved ? 'Annuler' : 'R√©server'}</button>
                        <button onclick="openGoogleMaps('${spot.googleMapsUrl}')">Voir sur Google Maps</button>
                    </div>
                `;
            } catch (e) {
                console.error('Erreur cr√©ation popup:', e);
                return '<div class="ad-popup">Erreur chargement d√©tails</div>';
            }
        }

        function updateMarkers(lang) {
            try {
                if (!mapFr) {
                    console.warn('MapFr non d√©fini');
                    return;
                }
                console.log('Mise √† jour marqueurs...');
                markers.forEach(m => {
                    const spot = m.location;
                    const isReserved = reservedSpots.some(s => s.id === spot.id);
                    m.marker.bindPopup(createPopupContent(spot, isReserved, lang));
                    m.marker.on('click', () => {
                        console.log(`Clic sur marqueur ${spot.id} - ${spot.name}`);
                        m.marker.openPopup();
                        selectedLocationId = spot.id;
                        highlightLocationInList(spot.id);
                    });
                });
            } catch (e) {
                console.error('Erreur mise √† jour marqueurs:', e);
            }
        }

        function toggleReservation(id, name, button, lang) {
            try {
                console.log(`Toggle r√©servation pour spot ${id} - ${name}`);
                const popup = button.parentElement;
                if (!popup) {
                    console.error('Popup non trouv√© pour spot', id);
                    return;
                }
                const isReserved = popup.getAttribute('data-reserved') === 'true';
                popup.setAttribute('data-reserved', !isReserved);
                button.textContent = isReserved ? 'R√©server' : 'Annuler';

                if (!isReserved) {
                    reservedSpots.push({ id, name });
                } else {
                    reservedSpots = reservedSpots.filter(spot => spot.id !== id);
                }
                console.log('R√©servations actuelles:', reservedSpots);
                updateEmailBody(lang);
                updateMarkers(lang);
            } catch (e) {
                console.error('Erreur toggle r√©servation:', e);
            }
        }

        function openGoogleMaps(url) {
            try {
                console.log('Ouverture Google Maps:', url);
                window.open(url, '_blank');
            } catch (e) {
                console.error('Erreur Google Maps:', e);
            }
        }

        function updateEmailBody(lang) {
            try {
                console.log('Mise √† jour corps e-mail...');
                const emailBody = document.getElementById(`email-body-${lang}`);
                const sendButton = document.getElementById(`send-email-${lang}`);
                const resetButton = document.getElementById(`reset-button`);

                if (!emailBody || !sendButton || !resetButton) {
                    console.error('√âl√©ments e-mail non trouv√©s');
                    return;
                }

                if (reservedSpots.length > 0) {
                    const spotList = reservedSpots.map(spot => `Spot ${spot.id} - ${spot.name}`).join('\n');
                    emailBody.value = `Bonjour Patrick,\n\nJe souhaite r√©server les emplacements publicitaires suivants :\n\n${spotList}\n\nMerci de confirmer la disponibilit√© et de me fournir les prochaines √©tapes.\n\nCordialement,\n[Votre Nom]`;
                    sendButton.style.display = 'inline-block';
                    resetButton.style.display = 'inline-block';
                } else {
                    emailBody.value = `Instructions :\n1. Cliquez sur un emplacement sur la carte.\n2. Appuyez sur "R√©server" pour ajouter l'emplacement √† votre s√©lection.\n3. Consultez l'emplacement sur Google Maps en cliquant sur "Voir sur Google Maps".\n4. Une fois vos emplacements choisis, modifiez ce texte si n√©cessaire.\n5. Cliquez sur "Envoyer l'e-mail" pour soumettre votre demande √† Patrick.`;
                    sendButton.style.display = 'none';
                    resetButton.style.display = 'none';
                }
            } catch (e) {
                console.error('Erreur mise √† jour e-mail:', e);
            }
        }

        function resetReservations(lang) {
            try {
                console.log('R√©initialisation r√©servations...');
                reservedSpots = [];
                updateEmailBody(lang);
                updateMarkers(lang);
            } catch (e) {
                console.error('Erreur r√©initialisation:', e);
            }
        }

        function setupEventListeners(lang) {
            try {
                console.log('Configuration √©couteurs √©v√©nements...');
                const sendButton = document.getElementById(`send-email-${lang}`);
                const resetButton = document.getElementById(`reset-button`);

                if (!sendButton || !resetButton) {
                    console.error('Boutons non trouv√©s');
                    return;
                }

                sendButton.addEventListener('click', () => {
                    try {
                        console.log('Clic sur envoyer e-mail');
                        const emailBody = document.getElementById(`email-body-${lang}`);
                        const subject = encodeURIComponent("Demande de r√©servation d'emplacements publicitaires");
                        const body = encodeURIComponent(emailBody.value);
                        window.location.href = `mailto:patrick@xtranumerik.com?subject=${subject}&body=${body}`;
                    } catch (e) {
                        console.error('Erreur envoi e-mail:', e);
                    }
                });

                resetButton.addEventListener('click', () => {
                    console.log('Clic sur r√©initialiser');
                    resetReservations(lang);
                });
            } catch (e) {
                console.error('Erreur configuration √©couteurs:', e);
            }
        }

        // From second: generateLocationList adapted to adSpots
        function generateLocationList() {
            const locationList = document.getElementById('location-list');

            adSpots.forEach(spot => {
                const locationItem = document.createElement('div');
                locationItem.className = 'location-item';
                locationItem.id = `location-${spot.id}`;

                locationItem.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h4 style="margin-bottom: 0.5rem; color: var(--primary-color);">Spot ${spot.id} - ${spot.name}</h4>
                            <p style="font-size: 0.9rem; color: #666; margin-bottom: 0.5rem;">Lat: ${spot.lat}, Lng: ${spot.lng}</p>
                            <div style="display: flex; gap: 0.5rem;">
                                <span style="background: #ffc107; color: white; padding: 0.2rem 0.4rem; border-radius: 3px; font-size: 0.7rem;">
                                    Achalandage Moyen
                                </span>
                                <span style="background: #28a745; color: white; padding: 0.2rem 0.4rem; border-radius: 3px; font-size: 0.7rem;">
                                    Disponible
                                </span>
                            </div>
                        </div>
                        <div>
                            üìç
                        </div>
                    </div>
                `;

                locationItem.addEventListener('click', () => {
                    selectedLocationId = spot.id;
                    mapFr.setView([spot.lat, spot.lng], 15);

                    const marker = markers.find(m => m.location.id === spot.id);
                    if (marker) {
                        marker.marker.openPopup();
                    }

                    highlightLocationInList(spot.id);
                });

                locationList.appendChild(locationItem);
            });
        }

        function highlightLocationInList(locationId) {
            document.querySelectorAll('.location-item').forEach(item => {
                item.classList.remove('selected');
            });

            const locationElement = document.getElementById(`location-${locationId}`);
            if (locationElement) {
                locationElement.classList.add('selected');
                locationElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        // Control functions from second
        function centerMap() {
            mapFr.setView([46.0, -70.7], 8);
        }

        function showAllLocations() {
            const group = new L.featureGroup(markers.map(m => m.marker));
            mapFr.fitBounds(group.getBounds().pad(0.05));
        }

        function filterAvailable() {
            // Assuming all are available for simplicity, as per first script (no available field)
            const bounds = [];
            adSpots.forEach(spot => {
                bounds.push([spot.lat, spot.lng]);
            });

            if (bounds.length > 0) {
                mapFr.fitBounds(bounds, { padding: [20, 20] });
            }
        }
    </script>
</body>
</html>
